# =============================================================================
# Multi-Index RAG Finance - Environment Variables
# =============================================================================
# Copy this file to .env and fill in your actual values
# DO NOT commit .env to git!
# =============================================================================

# -----------------------------------------------------------------------------
# Supabase Configuration (Required)
# -----------------------------------------------------------------------------
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here
SUPABASE_ANON_KEY=your_anon_key_here

# -----------------------------------------------------------------------------
# Google Gemini AI (Required)
# -----------------------------------------------------------------------------
GEMINI_API_KEY=your_gemini_api_key_here
GEMINI_MODEL=gemini-2.5-flash

# -----------------------------------------------------------------------------
# Google Custom Search (Required for NewsAnalyst)
# Get from: https://developers.google.com/custom-search/v1/overview
# -----------------------------------------------------------------------------
GOOGLE_CUSTOM_SEARCH_API_KEY=your_google_search_api_key
GOOGLE_CUSTOM_SEARCH_ENGINE_ID=your_search_engine_id

# -----------------------------------------------------------------------------
# Redis Configuration
# -----------------------------------------------------------------------------
# For local development:
REDIS_URL=redis://localhost:6379
# For Docker (auto-overridden by docker-compose):
# REDIS_URL=redis://redis:6379

# -----------------------------------------------------------------------------
# JWT Authentication (Required)
# Generate a strong key: openssl rand -hex 32
# IMPORTANT: Only use alphanumeric characters, hyphens, underscores
# DO NOT use special characters like: * & ^ % $ # @ ! 
# -----------------------------------------------------------------------------
JWT_SECRET_KEY=your-super-secret-jwt-key-minimum-32-characters-long
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
DEBUG=False
LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# LLM Settings
# -----------------------------------------------------------------------------
GEN_MAX_TOKENS=8192
EMBEDDING_MODEL=BAAI/bge-m3

# -----------------------------------------------------------------------------
# API Server Settings
# -----------------------------------------------------------------------------
API_HOST=0.0.0.0
API_PORT=8000

# -----------------------------------------------------------------------------
# CORS Configuration
# For development: *
# For production: comma-separated list of allowed origins
# -----------------------------------------------------------------------------
CORS_ORIGINS=http://localhost:3000

# -----------------------------------------------------------------------------
# Domain Settings (Production only)
# -----------------------------------------------------------------------------
# DOMAIN=macroinsight.me
# PUBLIC_URL=https://macroinsight.me

# -----------------------------------------------------------------------------
# LangSmith Tracing (Optional)
# -----------------------------------------------------------------------------
LANGCHAIN_TRACING_V2=false
# LANGCHAIN_API_KEY=your_langsmith_api_key
# LANGCHAIN_PROJECT=multi_index_rag_pipeline

# -----------------------------------------------------------------------------
# NewsAnalyst Settings
# -----------------------------------------------------------------------------
NEWS_SCRAPE_INTERVAL_HOURS=4

# -----------------------------------------------------------------------------
# External Search Fallback (Step 9) - ENABLED with RATE LIMITING
# -----------------------------------------------------------------------------
# Enable fallback to Google Search when RAG retrieval is insufficient
FALLBACK_ENABLED=true
FALLBACK_RELEVANCE_THRESHOLD=0.35
FALLBACK_MIN_DOCS=1
FALLBACK_SEARCH_TEMPERATURE=0.0
FALLBACK_MAX_RESULTS=3
FALLBACK_TIMEOUT=10.0

# Fallback Rate Limiting (Security - prevent abuse & control costs)
# Max 5 calls per hour per user to prevent excessive Google Search API usage
FALLBACK_RATE_LIMIT_PER_USER=5
FALLBACK_RATE_LIMIT_WINDOW=3600

# -----------------------------------------------------------------------------
# Query Security (NEW - Phase 0)
# -----------------------------------------------------------------------------
# Enable Query Guard to block malicious queries before pipeline execution
QUERY_GUARD_ENABLED=true
QUERY_GUARD_MIN_FINANCE_SCORE=0.3

# Query Caching (Performance optimization)
QUERY_CACHE_ENABLED=true
QUERY_CACHE_TTL=1800

# -----------------------------------------------------------------------------
# OpenAI (Optional - if using OpenAI models)
# -----------------------------------------------------------------------------
# OPENAI_API_KEY=your_openai_api_key
